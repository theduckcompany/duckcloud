<!--Section: Content-->
<section id="content">
  <div class="card shadow-0">
    <div class="card-body">
      <div id="status-bar"></div>
      <div class="row justify-content-between">
        <div class="col-6">
          <nav aria-label="breadcrumb">
            <ol class="breadcrumb user-select-none">
              {{range .breadcrumb}}
              <li class="breadcrumb-item{{if not .Current}} active{{end}}" {{if .Current}}aria_current="page" {{end}}>
                {{if not .Current}}<a href="{{.Href}}">{{.Name}}</a>{{else}}{{.Name}}{{end}}
              </li>
              {{end}}
            </ol>
          </nav>
        </div>

        <div class="col-2">
          <button id="upload-btn" class="btn btn-primary button-lg">Upload</button>
        </div>
      </div>

      <br>

      <div class="row user-select-none">
        <div class="col-8">Name</div>
        <div class="col-2 text-muted">Size</div>
        <div class="col-2 text-muted">Modified</div>
      </div>

      <hr class="mb-1">

      {{range .inodes}}
      {{ $url := pathJoin "/browser" $.folder.ID $.fullPath .Name}}

      <a class="link-dark user-select-none" href=" {{$url}}">
        <div class="row border-bottom py-2 d-flex align-items-center">
          <div class="col-8"><i class="bi {{getInodeIconClass .Name .IsDir}}" style="font-size: 1.5rem;"></i> {{.Name}}
          </div>
          <div class="col-2 text-muted">{{humanSize .USize}}</div>
          <div class="col-2 text-muted">{{humanTime .LastModifiedAt}}</div>
        </div>
      </a>
      {{end}}
    </div>
  </div>
</section>
<script type="module">
  import {Uppy, XHRUpload, Dashboard, StatusBar} from "/assets/js/uppy.min.mjs"
  let client = new Uppy().use(XHRUpload, {
    endpoint: 'http://localhost:8080/browser/upload',
  })

  client.setMeta({rootPath: {{$.fullPath}}})
  client.setMeta({folderID: {{$.folder.ID}}})

  client.use(Dashboard, {
    fileManagerSelectionType: 'both',
    proudlyDisplayPoweredByUppy: false,
    trigger: "#upload-btn",
    showProgressDetails: true,
    closeModalOnClickOutside: true,
  })
  client.use(StatusBar, {target: '#status-bar'});
</script>
<!--Section: Content-->
